{"ast":null,"code":"import React,{createContext,useState,useContext,useEffect}from'react';import axios from'axios';import{useAuth}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext();export const useCart=()=>{return useContext(CartContext);};export const CartProvider=_ref=>{let{children}=_ref;const[cartItems,setCartItems]=useState([]);const[previewOpen,setPreviewOpen]=useState(false);const{user}=useAuth();useEffect(()=>{if(user){fetchCart();}else{setCartItems([]);}},[user]);const fetchCart=async()=>{try{const response=await axios.get('http://localhost:5000/api/cart');setCartItems(response.data);}catch(error){console.error('Error fetching cart:',error);}};const addToCart=async function(productId){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(!user){return{success:false,error:'Please login to add items to cart'};}try{await axios.post('http://localhost:5000/api/cart',{product_id:productId,quantity});await fetchCart();// show preview drawer briefly\nsetPreviewOpen(true);setTimeout(()=>setPreviewOpen(false),6000);return{success:true};}catch(error){var _error$response,_error$response$data;return{success:false,error:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Failed to add to cart'};}};const removeFromCart=async productId=>{try{await axios.delete(\"http://localhost:5000/api/cart/\".concat(productId));await fetchCart();return{success:true};}catch(error){var _error$response2,_error$response2$data;return{success:false,error:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||'Failed to remove from cart'};}};const clearCart=()=>{setCartItems([]);};const getCartTotal=()=>{return cartItems.reduce((total,item)=>total+item.price*item.cart_quantity,0);};const getCartItemsCount=()=>{return cartItems.reduce((count,item)=>count+item.cart_quantity,0);};const value={cartItems,addToCart,removeFromCart,clearCart,getCartTotal,getCartItemsCount,fetchCart,previewOpen,setPreviewOpen};return/*#__PURE__*/_jsx(CartContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","axios","useAuth","jsx","_jsx","CartContext","useCart","CartProvider","_ref","children","cartItems","setCartItems","previewOpen","setPreviewOpen","user","fetchCart","response","get","data","error","console","addToCart","productId","quantity","arguments","length","undefined","success","post","product_id","setTimeout","_error$response","_error$response$data","removeFromCart","delete","concat","_error$response2","_error$response2$data","clearCart","getCartTotal","reduce","total","item","price","cart_quantity","getCartItemsCount","count","value","Provider"],"sources":["C:/Users/user/ecommerce-web/frontend/src/context/CartContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const useCart = () => {\r\n  return useContext(CartContext);\r\n};\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [previewOpen, setPreviewOpen] = useState(false);\r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchCart();\r\n    } else {\r\n      setCartItems([]);\r\n    }\r\n  }, [user]);\r\n\r\n  const fetchCart = async () => {\r\n    try {\r\n      const response = await axios.get('http://localhost:5000/api/cart');\r\n      setCartItems(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching cart:', error);\r\n    }\r\n  };\r\n\r\n  const addToCart = async (productId, quantity = 1) => {\r\n    if (!user) {\r\n      return { success: false, error: 'Please login to add items to cart' };\r\n    }\r\n\r\n    try {\r\n      await axios.post('http://localhost:5000/api/cart', {\r\n        product_id: productId,\r\n        quantity\r\n      });\r\n      await fetchCart();\r\n      // show preview drawer briefly\r\n      setPreviewOpen(true);\r\n      setTimeout(() => setPreviewOpen(false), 6000);\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { \r\n        success: false, \r\n        error: error.response?.data?.error || 'Failed to add to cart' \r\n      };\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (productId) => {\r\n    try {\r\n      await axios.delete(`http://localhost:5000/api/cart/${productId}`);\r\n      await fetchCart();\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { \r\n        success: false, \r\n        error: error.response?.data?.error || 'Failed to remove from cart' \r\n      };\r\n    }\r\n  };\r\n\r\n  const clearCart = () => {\r\n    setCartItems([]);\r\n  };\r\n\r\n  const getCartTotal = () => {\r\n    return cartItems.reduce((total, item) => total + (item.price * item.cart_quantity), 0);\r\n  };\r\n\r\n  const getCartItemsCount = () => {\r\n    return cartItems.reduce((count, item) => count + item.cart_quantity, 0);\r\n  };\r\n\r\n  const value = {\r\n    cartItems,\r\n    addToCart,\r\n    removeFromCart,\r\n    clearCart,\r\n    getCartTotal,\r\n    getCartItemsCount,\r\n    fetchCart\r\n    ,previewOpen, setPreviewOpen\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={value}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,KAAQ,OAAO,CAC7E,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,OAAO,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAExC,KAAM,CAAAC,WAAW,cAAGR,aAAa,CAAC,CAAC,CAEnC,MAAO,MAAM,CAAAS,OAAO,CAAGA,CAAA,GAAM,CAC3B,MAAO,CAAAP,UAAU,CAACM,WAAW,CAAC,CAChC,CAAC,CAED,MAAO,MAAM,CAAAE,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACc,WAAW,CAAEC,cAAc,CAAC,CAAGf,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAEgB,IAAK,CAAC,CAAGZ,OAAO,CAAC,CAAC,CAE1BF,SAAS,CAAC,IAAM,CACd,GAAIc,IAAI,CAAE,CACRC,SAAS,CAAC,CAAC,CACb,CAAC,IAAM,CACLJ,YAAY,CAAC,EAAE,CAAC,CAClB,CACF,CAAC,CAAE,CAACG,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAf,KAAK,CAACgB,GAAG,CAAC,gCAAgC,CAAC,CAClEN,YAAY,CAACK,QAAQ,CAACE,IAAI,CAAC,CAC7B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC9C,CACF,CAAC,CAED,KAAM,CAAAE,SAAS,CAAG,cAAAA,CAAOC,SAAS,CAAmB,IAAjB,CAAAC,QAAQ,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAC9C,GAAI,CAACV,IAAI,CAAE,CACT,MAAO,CAAEa,OAAO,CAAE,KAAK,CAAER,KAAK,CAAE,mCAAoC,CAAC,CACvE,CAEA,GAAI,CACF,KAAM,CAAAlB,KAAK,CAAC2B,IAAI,CAAC,gCAAgC,CAAE,CACjDC,UAAU,CAAEP,SAAS,CACrBC,QACF,CAAC,CAAC,CACF,KAAM,CAAAR,SAAS,CAAC,CAAC,CACjB;AACAF,cAAc,CAAC,IAAI,CAAC,CACpBiB,UAAU,CAAC,IAAMjB,cAAc,CAAC,KAAK,CAAC,CAAE,IAAI,CAAC,CAC7C,MAAO,CAAEc,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOR,KAAK,CAAE,KAAAY,eAAA,CAAAC,oBAAA,CACd,MAAO,CACLL,OAAO,CAAE,KAAK,CACdR,KAAK,CAAE,EAAAY,eAAA,CAAAZ,KAAK,CAACH,QAAQ,UAAAe,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBb,IAAI,UAAAc,oBAAA,iBAApBA,oBAAA,CAAsBb,KAAK,GAAI,uBACxC,CAAC,CACH,CACF,CAAC,CAED,KAAM,CAAAc,cAAc,CAAG,KAAO,CAAAX,SAAS,EAAK,CAC1C,GAAI,CACF,KAAM,CAAArB,KAAK,CAACiC,MAAM,mCAAAC,MAAA,CAAmCb,SAAS,CAAE,CAAC,CACjE,KAAM,CAAAP,SAAS,CAAC,CAAC,CACjB,MAAO,CAAEY,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOR,KAAK,CAAE,KAAAiB,gBAAA,CAAAC,qBAAA,CACd,MAAO,CACLV,OAAO,CAAE,KAAK,CACdR,KAAK,CAAE,EAAAiB,gBAAA,CAAAjB,KAAK,CAACH,QAAQ,UAAAoB,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBlB,IAAI,UAAAmB,qBAAA,iBAApBA,qBAAA,CAAsBlB,KAAK,GAAI,4BACxC,CAAC,CACH,CACF,CAAC,CAED,KAAM,CAAAmB,SAAS,CAAGA,CAAA,GAAM,CACtB3B,YAAY,CAAC,EAAE,CAAC,CAClB,CAAC,CAED,KAAM,CAAA4B,YAAY,CAAGA,CAAA,GAAM,CACzB,MAAO,CAAA7B,SAAS,CAAC8B,MAAM,CAAC,CAACC,KAAK,CAAEC,IAAI,GAAKD,KAAK,CAAIC,IAAI,CAACC,KAAK,CAAGD,IAAI,CAACE,aAAc,CAAE,CAAC,CAAC,CACxF,CAAC,CAED,KAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,MAAO,CAAAnC,SAAS,CAAC8B,MAAM,CAAC,CAACM,KAAK,CAAEJ,IAAI,GAAKI,KAAK,CAAGJ,IAAI,CAACE,aAAa,CAAE,CAAC,CAAC,CACzE,CAAC,CAED,KAAM,CAAAG,KAAK,CAAG,CACZrC,SAAS,CACTW,SAAS,CACTY,cAAc,CACdK,SAAS,CACTC,YAAY,CACZM,iBAAiB,CACjB9B,SAAS,CACRH,WAAW,CAAEC,cAChB,CAAC,CAED,mBACET,IAAA,CAACC,WAAW,CAAC2C,QAAQ,EAACD,KAAK,CAAEA,KAAM,CAAAtC,QAAA,CAChCA,QAAQ,CACW,CAAC,CAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}